# ConvTranspose2d

# è®¾å®šä¸€ä¸ªæœ€ç®€å•ä¾‹å­

æˆ‘ä»¬ç”¨ï¼š

* è¾“å…¥ featureï¼š2Ã—2
* ConvTranspose2d å‚æ•°ï¼š

```
kernel = 2Ã—2
stride = 2
padding = 0
bias = 0
```

æƒé‡ kernelï¼š

```
W =
[[1, 2],
 [3, 4]]
```

è¾“å…¥ Xï¼š

```
X =
[[5, 6],
 [7, 8]]
```

---

# ConvTranspose çš„è§„åˆ™ï¼ˆäºŒç»´ï¼‰

æ ¸å¿ƒæœºåˆ¶ï¼š

---

## æ¯ä¸€ä¸ªè¾“å…¥åƒç´ 

â†’ ä¹˜ kernel

â†’ â€œé“ºâ€åˆ°è¾“å‡ºç©ºé—´å¯¹åº”åŒºåŸŸ

â†’ é‡å ä½ç½®ç›¸åŠ 

---

ä¸æ˜¯æ»‘çª—ã€‚

è€Œæ˜¯ï¼š

---

# pixel splatting

---

æˆ‘ä»¬å¼€å§‹ã€‚

---

# Step 1ï¼šåˆå§‹åŒ–è¾“å‡º

stride=2ï¼Œè¾“å…¥ 2Ã—2ï¼Œkernel 2Ã—2ï¼š

è¾“å‡ºå¤§å°ï¼š

```
(2-1)*2 + 2 = 4
```

æ‰€ä»¥ï¼š

```
Output = 4Ã—4 å…¨ 0
```

---

```
O =
[[0,0,0,0],
 [0,0,0,0],
 [0,0,0,0],
 [0,0,0,0]]
```

---

# Step 2ï¼šå¤„ç† X[0,0] = 5

ä½ç½®ï¼š

```
(0*2, 0*2) = (0,0)
```

ä¹˜ kernelï¼š

```
5Ã—W =
[[5,10],
 [15,20]]
```

åŠ åˆ°è¾“å‡ºå·¦ä¸Šï¼š

```
O =
[[ 5,10, 0, 0],
 [15,20, 0, 0],
 [ 0, 0, 0, 0],
 [ 0, 0, 0, 0]]
```

---

# Step 3ï¼šå¤„ç† X[0,1] = 6

ä½ç½®ï¼š

```
(0*2,1*2) = (0,2)
```

kernel Ã—6ï¼š

```
[[ 6,12],
 [18,24]]
```

åŠ åˆ°ï¼š

```
O =
[[ 5,10, 6,12],
 [15,20,18,24],
 [ 0, 0, 0, 0],
 [ 0, 0, 0, 0]]
```

---

# Step 4ï¼šå¤„ç† X[1,0] = 7

ä½ç½®ï¼š

```
(2,0)
```

7Ã—kernelï¼š

```
[[ 7,14],
 [21,28]]
```

åŠ ï¼š

```
O =
[[ 5,10, 6,12],
 [15,20,18,24],
 [ 7,14, 0, 0],
 [21,28, 0, 0]]
```

---

# Step 5ï¼šå¤„ç† X[1,1] = 8

ä½ç½®ï¼š

```
(2,2)
```

8Ã—kernelï¼š

```
[[ 8,16],
 [24,32]]
```

æœ€ç»ˆï¼š

```
O =
[[ 5,10, 6,12],
 [15,20,18,24],
 [ 7,14, 8,16],
 [21,28,24,32]]
```

---

# ğŸ‰ è¿™å°±æ˜¯ ConvTranspose2d çš„å®Œæ•´ç»“æœã€‚

---

# ä½ ç°åœ¨åº”è¯¥æ¸…æ¥šçœ‹åˆ°ï¼š

---

## æ²¡æœ‰ sliding window

## æ˜¯æ¯ä¸ªè¾“å…¥ç‚¹å¾€å¤–â€œæ’’ kernelâ€

---

# å¦‚æœ stride=1 ä¼šæ€æ ·ï¼Ÿ

åŒºåŸŸä¼šé‡å ï¼š

é‡å ä½ç½®ç›´æ¥ç›¸åŠ ï¼š

---

è¿™æ­£æ˜¯ checkerboard æ¥æºã€‚

---

# ä¸€çœ¼è®°ä½ï¼š

---

## Conv2dï¼š

çª—å£åœ¨å›¾ä¸Šæ»‘ã€‚

---

## ConvTranspose2dï¼š

åƒç´ åœ¨å›¾ä¸Šç‚¸ã€‚

---

---

# å¯¹æ¯” Upsampleï¼ˆåŒè¾“å…¥ï¼‰

å¦‚æœç”¨ï¼š

```python
Upsample(scale=2, nearest)
```

Xï¼š

```
[[5,6],
 [7,8]]
```

å˜ï¼š

```
[[5,5,6,6],
 [5,5,6,6],
 [7,7,8,8],
 [7,7,8,8]]
```

å®Œå…¨ä¸åŒã€‚

---

# æœ€ç»ˆæ€»ç»“ï¼ˆç”¨ä½ ç°åœ¨èƒ½æ„ŸçŸ¥çš„äºŒç»´ï¼‰

---

ConvTranspose2d åœ¨ 2D ä¸­ï¼š

---

# æ¯ä¸ªè¾“å…¥å…ƒç´ ä¹˜ kernelï¼ŒæŒ‰ stride é—´éš”é“ºå¼€ï¼Œç›¸åŠ å½¢æˆè¾“å‡ºã€‚

---

ä¸æ˜¯é€†å·ç§¯ã€‚

ä¸æ˜¯æ’å€¼ã€‚

æ˜¯ï¼š

---

# pixel â†’ patch

---

# UpsamplingBilinear2d
```python
>>> m = nn.UpsamplingBilinear2d(scale_factor=2)
>>> input = torch.arange(1, 10, dtype=torch.float32).view(1, 1, 3, 3)
>>> output=m(input)
>>> output
tensor([[[[1.0000, 1.4000, 1.8000, 2.2000, 2.6000, 3.0000],
          [2.2000, 2.6000, 3.0000, 3.4000, 3.8000, 4.2000],
          [3.4000, 3.8000, 4.2000, 4.6000, 5.0000, 5.4000],
          [4.6000, 5.0000, 5.4000, 5.8000, 6.2000, 6.6000],
          [5.8000, 6.2000, 6.6000, 7.0000, 7.4000, 7.8000],
          [7.0000, 7.4000, 7.8000, 8.2000, 8.6000, 9.0000]]]])
```
